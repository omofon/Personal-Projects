Time Tracking Dashboard

Hey everyone,
this is my coding journal where I write thought processes on how i worked out the projects and tasks i have to do

This is a frontend mentor project, a time tracking dashboard which displays hours spent on activities by a user
The time periods are "hourly", "daily", "weekly". There are 6 activities which are: work, play, study, exercise, social, self care.

I started off with the logic and scripts because that was the toughest part of building this project for me. I will guide you through on how I was able to make the period buttons functional.

The preview image was given so i had an idea of the the design should be but not specifications (I haven't subscribed for pro yet)

The User profile card has a bit of info to the owner of these data and the buttons for the time period

```html
	      <!-- Profile Card for User: Jeremy Robson -->
      <article class="profile-card">
        <section class="profile-card__report">
          <img
            class="profile-card__avatar"
            src="/images/image-jeremy.png"
            alt="Jeremy Robson Avatar"
          />
          <div class="profile-card__user-info">
            <p class="profile-card__label">Report for</p>
            <h2 class="profile-card__name">Jeremy Robson</h2>
          </div>
        </section>

        <nav class="profile-card__time-controls">
          <ul class="time-controls__list">
            <li class="time-controls__item">
              <button class="time-controls__button" data-period="daily">
                Daily
              </button>
            </li>
            <li class="time-controls__item">
              <button
                class="time-controls__button time-controls__button--active"
                data-period="weekly"
              >
                Weekly
              </button>
            </li>
            <li class="time-controls__item">
              <button class="time-controls__button" data-period="monthly">
                Monthly
              </button>
            </li>
          </ul>
        </nav>
      </article>
```
My concern with the codeblock above is the list of buttons. each button has a claas, time-controls__button (a BEM style naming nommenclature) and data attribute, data-period with values: daily, weekly, and monthly 
These buttons will be accessed in the script with the data-period attribute which values are lower-cased.

For the activity cards:
```html
	      <!-- Activity Card: Work -->
      <article class="activity-card activity-card--work">
        <div class="activity-card__decorative-header">
          <img src="/images/icon-work.svg" alt="Briefcase icon" />
        </div>

        <div class="activity-card__content-box">
          <div class="activity-card__heading">
            <h3 class="activity-card__title">Work</h3>
            <button class="activity-card__menu-btn">
              <img src="/images/icon-ellipsis.svg" alt="Options menu icon" />
            </button>
          </div>

          <div class="activity-card__time-data">
            <h1 class="activity-card__current-time">32hrs</h1>
            <p class="activity-card__previous-time">Last Week - 36hrs</p>
          </div>
        </div>
      </article>

```

It would be stressful for me now, having a function to create the activity cards. this will prevent code repition but will undoubtedly complicated things for me as a newbie.
So no, i didn't.

What we need from the activity card are the title, current time and previous time
`
	            <h3 class="activity-card__title">Work</h3>
	            <h1 class="activity-card__current-time">32hrs</h1>
            <p class="activity-card__previous-time">Last Week - 36hrs</p>
`
These are the domnodes that will be update or used for validification.

Over to the script.
We will be getting data from a json file and making update to the dom.
Snippet of data.json:
```json
	[
  {
    "title": "Work",
    "timeframes": {
      "daily": {
        "current": 5,
        "previous": 7
      },
      "weekly": {
        "current": 32,
        "previous": 36
      },
      "monthly": {
        "current": 103,
        "previous": 128
      }
    }
  },
]
```

The first thing we do is fetch data from file and return a json response. This function is an async function because fetch method returns a promise and we must await it, log error if the fetch fails
```
  const fetchData = async (dataSource) => {
    try {
      const response = await fetch(dataSource);

      if (!response.ok) {
        throw new Error(`HTTP Error! Status: ${response.status}`);
      }
      return await response.json();
    } catch (error) {
      console.error("Failed fetch:", error);
      return false;
    }
  };

```

then from the response.json() we can now filter the period to be requested. We write a getPeriodData function which return an object `{
          title: title of period,
          current: current time,
          previous: previous time,
        };`

```javascript  /* ==== Returns a object of title, current and previous from json data ==== */
  const getPeriodData = (data, period) => {
    const transformedData = data
      .map((activity) => {
        const title = activity.title;
        const timeData = activity.timeframes[period];

        if (!timeData) {
          console.error(`Data for period: ${period} not found in ${title}`);
          return null;
        }

        return {
          title: title,
          current: timeData.current,
          previous: timeData.previous,
        };
      })
      .filter((item) => item != null);

    return transformedData;
  };
```

now lets summarize what we did. we fetch data async from the json file and we can get the data for a specific timeframe/period

the next thing to do now is to wrtie the timeframe data to the dom nodes we picked out for the activity card
previous and current times.

iterating over the period data using forEach(fn), we convert the title to lowercase safe form, qury the dom for element with class if tue, get currentelement and previous element and then write to the esle throw error
            <h3 class="activity-card__title">Work</h3>
            <h1 class="activity-card__current-time">32hrs</h1>
            <p class="activity-card__previous-time">Last Week - 36hrs</p>

You will notice that previous time dom has additioal textcontent "Last Week" which changes with periods. we have to ensure we have aslo the right pretext for each period
```
const renderData = (data, period) => {
    const periodData = getPeriodData(data, period);

    let prevText = "Yesterday";
    if (period === "weekly") {
      prevText = " Last Week";
    } else if (period === "monthly") {
      prevText = "Last Month";
    }

    periodData.forEach((item) => {
      const safeTitle = item.title.toLowerCase().replace(/\s/g, "-");
      const cardElement = document.querySelector(
        `.activity-card--${safeTitle}`
      );

      if (cardElement) {
        const currentElement = cardElement.querySelector(
          ".activity-card__current-time"
        );
        const previousElement = cardElement.querySelector(
          ".activity-card__previous-time"
        );

        currentElement.textContent = `${item.current}hrs`;
        previousElement.textContent = `${prevText} - ${item.previous}hrs`;
      } else {
        console.warn(`HTML card not found for title: ${item.title}`);
      }
    });
  };
```

next we add event listeners to the buttons. we get the period buttons, loop over each button and listen for click. if yes, we get the timeframe for period from data attribute (event.currentTarget.dataset.period)
if we can successfully fetch the data from the json file, we write/render it to the dom.
then we remove all other active button and assign active class to the clicked button
```
const attachEventListeners = () => {
    periodBtns.forEach((button) => {
      button.addEventListener("click", (event) => {
        const selectedPeriod = event.currentTarget.dataset.period;

        if (actualData) {
          renderData(actualData, selectedPeriod);

          periodBtns.forEach((btn) =>
            btn.classList.remove("time-controls__button--active")
          );
          event.currentTarget.classList.add("time-controls__buttons--active");
        }
      });
    });
  };
```
and we are done
i noticed too that some people have a parent add event listener for DOMContentLoaded, why? dont know yet
then also, i had to assign actualData ie the fetched data from json to global and null so that it doeant have to load everytime the page the pipeline is called

because fetchData function is an async function, have other functions in sync mode will create a promise object failure. so i wrote a pipeline function to await data from the fetchData function, render it when gotten and run the button even listener function, then i started the pipeline

the full code
```javascript
document.addEventListener("DOMContentLoaded", () => {
  const periodBtns = document.querySelectorAll("button[data-period]");

  let actualData = null;

  /* ==== Fetch Data ==== */
  const fetchData = async (dataSource) => {
    try {
      const response = await fetch(dataSource);

      if (!response.ok) {
        throw new Error(`HTTP Error! Status: ${response.status}`);
      }
      return await response.json();
    } catch (error) {
      console.error("Failed fetch:", error);
      return false;
    }
  };

  /* ==== Returns a object of title, current and previous from json data ==== */
  const getPeriodData = (data, period) => {
    const transformedData = data
      .map((activity) => {
        const title = activity.title;
        const timeData = activity.timeframes[period];

        if (!timeData) {
          console.error(`Data for period: ${period} not found in ${title}`);
          return null;
        }

        return {
          title: title,
          current: timeData.current,
          previous: timeData.previous,
        };
      })
      .filter((item) => item != null);

    return transformedData;
  };

  /* ==== Renders data from getPeriodData to HTML Cards ==== */
  const renderData = (data, period) => {
    const periodData = getPeriodData(data, period);

    let prevText = "Yesterday";
    if (period === "weekly") {
      prevText = " Last Week";
    } else if (period === "monthly") {
      prevText = "Last Month";
    }

    periodData.forEach((item) => {
      const safeTitle = item.title.toLowerCase().replace(/\s/g, "-");
      const cardElement = document.querySelector(
        `.activity-card--${safeTitle}`
      );

      if (cardElement) {
        const currentElement = cardElement.querySelector(
          ".activity-card__current-time"
        );
        const previousElement = cardElement.querySelector(
          ".activity-card__previous-time"
        );

        currentElement.textContent = `${item.current}hrs`;
        previousElement.textContent = `${prevText} - ${item.previous}hrs`;
      } else {
        console.warn(`HTML card not found for title: ${item.title}`);
      }
    });
  };

  /* ==== Add event listeners for time control buttons ==== */
  const attachEventListeners = () => {
    periodBtns.forEach((button) => {
      button.addEventListener("click", (event) => {
        const selectedPeriod = event.currentTarget.dataset.period;

        if (actualData) {
          renderData(actualData, selectedPeriod);

          periodBtns.forEach((btn) =>
            btn.classList.remove("time-controls__button--active")
          );
          event.currentTarget.classList.add("time-controls__buttons--active");
        }
      });
    });
  };

  /* ==== Creating a pipeline to ensure async functionality ==== */
  const initializePipeline = async () => {
    const data = await fetchData("/data.json");

    if (data) {
      actualData = data;
      console.log("Data loaded succesfully.");

      renderData(actualData, "weekly");
      attachEventListeners();
    } else {
      console.error("Pipeline initialization failed.");
    }
  };

  // Start the pipeline
  initializePipeline();
});
```

Now i style the website with tailwindcss

is there something that can be optimised here?
I'd love to hear feedbacks